<div class="container">
  <h1>Delivery Tracker Dashboard</h1>

  <!-- Sezione Form Nuova Consegna -->
  <div class="form-container">
    <h3>Registra Nuova Consegna</h3>
    <div class="form-group">
      <input [(ngModel)]="newDelivery.tracking_code" placeholder="Codice Tracking (univoco)">
      <input [(ngModel)]="newDelivery.recipient" placeholder="Nome Destinatario">
    </div>
    <div class="form-group">
      <input [(ngModel)]="newDelivery.address" placeholder="Indirizzo di consegna">
      <input [(ngModel)]="newDelivery.time_slot" placeholder="Fascia Oraria (es. 14:00-16:00)">
    </div>
    <div class="form-group">
      <label>Priorit√†: </label>
      <select [(ngModel)]="newDelivery.priority">
        <option value="LOW">LOW</option>
        <option value="MEDIUM">MEDIUM</option>
        <option value="HIGH">HIGH</option>
      </select>
      <button (click)="submitDelivery()" class="btn-add">Aggiungi Consegna</button>
    </div>
  </div>

  <hr>

  <h2>Lista Consegne</h2>
  <div class="grid">
    <div *ngFor="let d of deliveries" 
         class="card" 
         [ngClass]="d.status.toLowerCase()">
      
      <div *ngIf="d.priority === 'HIGH'" class="priority-badge">HIGH PRIORITY</div>

      <h3>Codice: {{ d.tracking_code }}</h3>
      <p><strong>Destinatario:</strong> {{ d.recipient }}</p>
      <p><strong>Indirizzo:</strong> {{ d.address }}</p>
      <p><strong>Fascia Oraria:</strong> {{ d.time_slot }}</p>
      <div class="status-text">Stato: {{ d.status }}</div>

      <!-- Sezione pulsanti cambio stato -->
      <div class="actions">
        <button (click)="changeStatus(d.id, 'READY')" class="btn-status grey" [disabled]="d.status === 'READY'">Ready</button>
        <button (click)="changeStatus(d.id, 'OUT_FOR_DELIVERY')" class="btn-status blue" [disabled]="d.status === 'OUT_FOR_DELIVERY'">Out</button>
        <button (click)="changeStatus(d.id, 'DELIVERED')" class="btn-status green" [disabled]="d.status === 'DELIVERED'">Delivered</button>
        <button (click)="changeStatus(d.id, 'FAILED')" class="btn-status red" [disabled]="d.status === 'FAILED'">Failed</button>
      </div>
    </div>
  </div>
</div>